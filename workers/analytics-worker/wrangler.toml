name = "epir-analityc-worker"
main = "src/index.ts"
compatibility_date = "2025-09-30"
compatibility_flags = ["nodejs_compat"]
workers_dev = false

[build]
command = ""

[[d1_databases]]
binding = "DB"
database_name = "epir_art_jewellery"
database_id = "6a4f7cbb-3c1c-42c7-9d79-4ef74d421f23"

# Durable Object binding for Session tracking
[[durable_objects.bindings]]
name = "SESSION_DO"
class_name = "SessionDO"
script_name = "epir-art-jewellery-worker"

# ============================================================================
# SERVICE BINDING: AI Worker for customer behavior analysis
# ============================================================================
# Analytics worker calls AI worker via Service Binding (zero-cost RPC)
# AI worker performs ML scoring and proactive chat recommendations
# @see https://developers.cloudflare.com/workers/runtime-apis/bindings/service-bindings/
[[services]]
binding = "AI_WORKER"
service = "epir-ai-worker"

[observability]
enabled = true
[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true
# Log filter: Only logs from THIS worker (epir-analityc-worker)
# Use filter in Cloudflare dashboard: ScriptName == "epir-analityc-worker"
